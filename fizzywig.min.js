(function(a,b){function d(){var a={},b={};return a.on=function(c,d){return c=c.split(/\s+/),c.forEach(function(a){b[a]=b[a]||[],b[a].indexOf(d)===-1&&b[a].push(d)}),a},a.off=function(c,d){return c=c.split(/\s+/),c.forEach(function(a){if(b[a]){var c=b[a].indexOf(d);b[a]=b[a].slice(0,c).concat(b[a].slice(c+1))}}),a},a.emit=function(a,c){a=a.split(/\s+/),a.forEach(function(a){b[a]&&b[a].forEach(function(a){a.apply(this,c)})})},a}function e(b,d){var e={},f,g,i;return typeof b=="string"?f=document.querySelector(b):b instanceof Element&&(f=b),g=f.querySelectorAll("[data-content-editor-command]"),g=Array.prototype.map.apply(g,[function(a){return h(a)}]),e.enable=function(){return g.forEach(function(a){a.enable()}),e},e.disable=function(){return g.forEach(function(a){a.disable()}),e},c.emitter.on("focus",function(){i=!0,e.enable()}),c.emitter.on("blur",function(b){var c;a.getSelection?(c=a.getSelection(),c.rangeCount&&(c=c.getRangeAt(0))):document.selection&&(c=document.selection.createRange()),i=!1,setTimeout(function(){i||e.disable()},150)}),c.emitter.on("click",function(){i=!0}),e.disable()}function f(a,b){function f(a){return function(b){c.emitter.emit(a)}}var d={},e;return e=a.getAttribute("data-content-editable")||"data",d.enable=function(){return a.setAttribute("contentEditable",!0),d},d.disable=function(){return a.removeAttribute("contentEditable"),d},d.json=function(){var b={};return j(b,e,a.innerHTML),b},k(a,"focus",f("focus")),k(a,"blur",f("blur")),k(a,"keyup",f("keyup")),k(a,"mouseup",f("mouseup")),d.enable()}function h(a){function f(){}function g(a){return function(b){c.emitter.emit(a)}}function h(a){a.preventDefault(),c.emitter.emit("click"),document.execCommand(d,!1,e)}var b={},d,e;return d=a.getAttribute("data-content-editor-command"),e=a.getAttribute("data-content-editor-value"),b.enable=function(){a.removeAttribute("disabled")},b.disable=function(){a.setAttribute("disabled","disabled")},b.activate=function(){m(a,"active")},b.deactivate=function(){n(a,"active")},c.emitter.on("keyup mouseup",f),k(a,"click",h),k(a,"blur",g("blur")),k(a,"focus",g("focus")),b}function i(){var a=Array.prototype.slice.apply(arguments);return a.reduce(function(a,b){return Object.keys(b).forEach(function(c){a[c]&&a[c].constructor===Object&&b[c].constructor===Object?i(a[c],b[c]):a[c]=b[c]}),a})}function j(a,b,c){function d(a,b,c,d){return a[b]}function e(a,b,d,e){return d===e.length-1?a[b]=c:a[b]||(a[b]={})}return typeof b=="string"&&(b=b.split(".")),b.reduce(typeof c=="undefined"?d:e,a)}function k(a,b,c,d){a.addEventListener?a.addEventListener(b,o.apply(this,[c]),d||!1):a.attachEvent&&a.attachEvent("on"+b,o.apply(this,[c]))}function l(a,b,c){a.addEventListener?a.removeEventListener(b,o.apply(this,[c])):a.attachEvent&&a.detachEvent("on"+b,o.apply(this,[c]))}function m(a,b){var c=a.className.split(/\s+/);c.indexOf(b)===-1&&c.push(b),a.className=c.join(" ")}function n(a,b){var c=a.className.split(/\s+/),d=c.indexOf(b);d!==-1&&(c=c.slice(0,d).concat(c.slice(d+1))),a.className=c.join(" ")}function o(b){return function(c){c||(c=a.event);if(!("defaultPrevented"in c)){c.defaultPrevented=!1;var d=c.preventDefault;c.preventDefault=function(){this.defaultPrevented=!0,this.returnValue=!1,d.call(this)}}c.target=c.target||c.srcElement,c.which=c.keyCode||c.charCode,b.apply(this,[c])}}var c;c={version:"0.0.1"},c.emitter=d(),c.content=function(a){function l(){if(j)return;j=setTimeout(function(){var a=b.json();JSON.stringify(k)!==JSON.stringify(a)&&(c.emitter.emit("save",[a]),k=a),j=null},2e3)}var b={},d,g,h,j,k={};if(typeof a=="string")d=document.querySelectorAll(a);else if(a instanceof d||Array.isArray(a))d=a;return d=Array.prototype.map.apply(d,[function(a){return f(a,b)}]),b.toolbar=function(a){return arguments.length?(g=e(a,b),b):g},b.enable=function(){return d.forEach(function(a){a.enable()}),b},b.disable=function(){return d.forEach(function(a){a.disable()}),b},b.json=function(){var a={},b=d.map(function(a){return a.json()});return b.unshift(a),i.apply(null,b),a},b.on=c.emitter.on,c.emitter.on("keyup change blur",l),b.enable()};var g=["h1","h2","h3","h4","h5","h6","p"];a.fizzywig=c})(window);